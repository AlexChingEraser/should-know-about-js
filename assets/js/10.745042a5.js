(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{283:function(s,t,a){"use strict";a.r(t);var e=a(14),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),t("h2",{attrs:{id:"base-knowledge"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#base-knowledge"}},[s._v("#")]),s._v(" Base Knowledge")]),s._v(" "),t("ol",[t("li",[t("code",[s._v(".dockerignore")])])]),s._v(" "),t("h2",{attrs:{id:"base-command"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#base-command"}},[s._v("#")]),s._v(" Base Command")]),s._v(" "),t("h2",{attrs:{id:"publish-node-js-app"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#publish-node-js-app"}},[s._v("#")]),s._v(" publish Node.js App")]),s._v(" "),t("h3",{attrs:{id:"confuse"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#confuse"}},[s._v("#")]),s._v(" Confuse~~")]),s._v(" "),t("p",[s._v("One thing confused me first is how "),t("code",[s._v("node_modules")]),s._v(" attached in application, C# will have "),t("code",[s._v("dot-net build/publish")]),s._v(", C have "),t("code",[s._v("gcc")]),s._v(", Java have "),t("code",[s._v("javac")]),s._v(", but how Node.js publish with these node packages?\nwell, some practise list here:")]),s._v(" "),t("ol",[t("li",[s._v("multi-stage build")])]),s._v(" "),t("div",{staticClass:"language-Dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" node:14.4.0 "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" build")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" . .")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" npm ci && npm run build")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" node:slim-14.4.0")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USER")]),s._v(" node")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPOSE")]),s._v(" 8080")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("COPY")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token options"}},[t("span",{pre:!0,attrs:{class:"token property"}},[s._v("--from")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("build")])]),s._v(" /home/node/app/dist /home/node/app/package.json /home/node/app/package-lock.json ./")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" npm ci --production")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token instruction"}},[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" [ "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"node"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dist/app.js"')]),s._v(" ]")]),s._v("\n")])])])])}),[],!1,null,null,null);t.default=n.exports}}]);